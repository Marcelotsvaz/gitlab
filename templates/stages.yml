stages:
  - &build ğŸ› ï¸  Build
  - &test ğŸ§ª  Test
  - &staging ğŸ—ï¸  Staging
  - &testStaging ğŸ§ªğŸ—ï¸  Test Staging
  - &cleanup ğŸ—‘ï¸  Clean Up
  - &deploy ğŸš€  Deploy
  - &release ğŸ“¦  Release



# 
# Templates.
#-------------------------------------------------------------------------------
.baseStage:
  script:
    - echo Running job '${CI_JOB_NAME}' with an empty script.


.runOnTags:
  rules:
    - if: $CI_COMMIT_TAG_MESSAGE


.runOnMergeRequests:
  rules:
    - if: $CI_PIPELINE_SOURCE == 'merge_request_event'



# 
# Stages.
#-------------------------------------------------------------------------------
.build:
  stage: *build
  extends: .baseStage


.test:
  stage: *test
  extends: .baseStage


.staging:
  stage: *staging
  extends:
    - .baseStage
    - .runOnMergeRequests


.testStaging:
  stage: *testStaging
  extends:
    - .baseStage
    - .runOnMergeRequests


.cleanup:
  stage: *cleanup
  extends:
    - .baseStage
    - .runOnMergeRequests


.deploy:
  stage: *deploy
  extends:
    - .baseStage
    - .runOnTags


.release:
  stage: *release
  extends:
    - .baseStage
    - .runOnTags